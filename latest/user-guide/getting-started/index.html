<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The fastest way to bring multi-agent workflows to production."><meta name=author content=airt><link href=https://fastagency.ai/latest/user-guide/getting-started/ rel=canonical><link href=../ rel=prev><link href=../cookiecutter/ rel=next><link rel=icon href=../../assets/img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.42"><title>Getting Started - FastAgency</title><link rel=stylesheet href=../../assets/stylesheets/main.0253249f.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.914002.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-X9JHPKFSDN"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-X9JHPKFSDN",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-X9JHPKFSDN",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta property=og:type content=website><meta property=og:title content="FastAgency - Getting Started"><meta property=og:description content="The fastest way to bring multi-agent workflows to production."><meta content=https://fastagency.ai/latest/user-guide/getting-started/ property=og:url><meta property=og:image content=https://fastagency.ai/latest/assets/img/FA-Main-LOGO-640x320-tinypng.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="FastAgency - Getting Started"><meta name=twitter:description content="The fastest way to bring multi-agent workflows to production."><meta name=twitter:image content=https://fastagency.ai/latest/assets/img/FA-Main-LOGO-640x320-tinypng.png><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#getting-started-with-fastagency class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest version. <a href=../../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=FastAgency class="md-header__button md-logo" aria-label=FastAgency data-md-component=logo> <img src=../../assets/img/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> FastAgency </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Getting Started </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=custom aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/airtai/fastagency title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> airtai/fastagency </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../features/ class=md-tabs__link> Features </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> User guide </a> </li> <li class=md-tabs__item> <a href=../../tutorials/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../api/fastagency/FastAgency/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../release/ class=md-tabs__link> Release Notes </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=FastAgency class="md-nav__button md-logo" aria-label=FastAgency data-md-component=logo> <img src=../../assets/img/logo.svg alt=logo> </a> FastAgency </label> <div class=md-nav__source> <a href=https://github.com/airtai/fastagency title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> airtai/fastagency </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../features/ class=md-nav__link> <span class=md-ellipsis> Features </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> User guide </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User guide </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Getting Started </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> <span class=md-ellipsis> Quick start </span> </a> <nav class=md-nav aria-label="Quick start"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#project-setup class=md-nav__link> <span class=md-ellipsis> Project setup </span> </a> </li> <li class=md-nav__item> <a href=#workflow-development class=md-nav__link> <span class=md-ellipsis> Workflow Development </span> </a> </li> <li class=md-nav__item> <a href=#workflow-deployment class=md-nav__link> <span class=md-ellipsis> Workflow Deployment </span> </a> </li> <li class=md-nav__item> <a href=#complete-application-code class=md-nav__link> <span class=md-ellipsis> Complete Application Code </span> </a> </li> <li class=md-nav__item> <a href=#run-application class=md-nav__link> <span class=md-ellipsis> Run Application </span> </a> </li> <li class=md-nav__item> <a href=#output class=md-nav__link> <span class=md-ellipsis> Output </span> </a> </li> <li class=md-nav__item> <a href=#building-the-docker-image class=md-nav__link> <span class=md-ellipsis> Building the Docker Image </span> </a> </li> <li class=md-nav__item> <a href=#running-the-docker-image class=md-nav__link> <span class=md-ellipsis> Running the Docker Image </span> </a> </li> <li class=md-nav__item> <a href=#deploying-to-flyio class=md-nav__link> <span class=md-ellipsis> Deploying to Fly.io </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cookiecutter/ class=md-nav__link> <span class=md-ellipsis> Project setup </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../runtimes/ class=md-nav__link> <span class=md-ellipsis> Runtimes </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../ui/ class=md-nav__link> <span class=md-ellipsis> UI </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../adapters/ class=md-nav__link> <span class=md-ellipsis> Adapters </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../api/ class=md-nav__link> <span class=md-ellipsis> API-s </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../testing/ class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> <li class=md-nav__item> <a href=../cli/ class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tutorials/ class=md-nav__link> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../api/fastagency/FastAgency/ class=md-nav__link> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../release/ class=md-nav__link> <span class=md-ellipsis> Release Notes </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> <span class=md-ellipsis> Quick start </span> </a> <nav class=md-nav aria-label="Quick start"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#project-setup class=md-nav__link> <span class=md-ellipsis> Project setup </span> </a> </li> <li class=md-nav__item> <a href=#workflow-development class=md-nav__link> <span class=md-ellipsis> Workflow Development </span> </a> </li> <li class=md-nav__item> <a href=#workflow-deployment class=md-nav__link> <span class=md-ellipsis> Workflow Deployment </span> </a> </li> <li class=md-nav__item> <a href=#complete-application-code class=md-nav__link> <span class=md-ellipsis> Complete Application Code </span> </a> </li> <li class=md-nav__item> <a href=#run-application class=md-nav__link> <span class=md-ellipsis> Run Application </span> </a> </li> <li class=md-nav__item> <a href=#output class=md-nav__link> <span class=md-ellipsis> Output </span> </a> </li> <li class=md-nav__item> <a href=#building-the-docker-image class=md-nav__link> <span class=md-ellipsis> Building the Docker Image </span> </a> </li> <li class=md-nav__item> <a href=#running-the-docker-image class=md-nav__link> <span class=md-ellipsis> Running the Docker Image </span> </a> </li> <li class=md-nav__item> <a href=#deploying-to-flyio class=md-nav__link> <span class=md-ellipsis> Deploying to Fly.io </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/airtai/fastagency/tree/main/docs/docs/en/user-guide/getting-started/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m7 14.94 6.06-6.06 2.06 2.06L9.06 17H7zM12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m4.7-10.65-1 1-2.05-2.05 1-1c.21-.22.56-.22.77 0l1.28 1.28c.22.21.22.56 0 .77M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2"/></svg> </a> <h1 id=getting-started-with-fastagency>Getting Started with FastAgency<a class=headerlink href=#getting-started-with-fastagency title="Permanent link">#</a></h1> <h2 id=quick-start>Quick start<a class=headerlink href=#quick-start title="Permanent link">#</a></h2> <p>We will show you four different setups, two for development and two for production workloads:</p> <ul> <li> <p>Development setups</p> <ul> <li> <p><strong>Console</strong>: This setup uses console for interactively executing your workflow. It is also very useful for automating testing and integration with CI/CD.</p> </li> <li> <p><strong>Mesop</strong>: This setup uses <a href=https://google.github.io/mesop/ target=_blank><strong>Mesop</strong></a> to build a web application for interacting with our workflow. It supports a single-worker deployments only, limiting its scalability. However, it is the fastest way to debug your application.</p> </li> </ul> </li> <li> <p>Production setups</p> <ul> <li> <p><strong>FastAPI + Mesop</strong>: This is fairly scalable setup using <a href=https://fastapi.tiangolo.com/ target=_blank><strong>FastAPI</strong></a> to execute your workflows and <a href=https://google.github.io/mesop/ target=_blank><strong>Mesop</strong></a> for interactive web application. <a href=https://fastapi.tiangolo.com/ target=_blank><strong>FastAPI</strong></a> supports execution with multiple workers, with each workflow being executed in the context of a WebSocket connection. <a href=https://google.github.io/mesop/ target=_blank><strong>Mesop</strong></a> is still limited to a single worker, although there is much less load of it due to workflows being executed in the <a href=https://fastapi.tiangolo.com/ target=_blank><strong>FastAPI</strong></a> workers.</p> </li> <li> <p><strong>NATS + FastAPI + Mesop</strong>: This is the most scalable setup using a distributed message broker <a href=https://nats.io/ target=_blank><strong>NATS.io MQ</strong></a>. Workflows are being executed with multiple workers that attach to the MQ waiting for initiate workflow messages. Such workers can be running on different machines or even different data centers/cloud providers. Message queues are highly scalable, but more difficult to integrate with end-clients. In order to make such integrations easier, we will connect our <a href=https://nats.io/ target=_blank><strong>NATS</strong></a>-based message queue with the <a href=https://fastapi.tiangolo.com/ target=_blank><strong>FastAPI</strong></a> application.</p> </li> </ul> </li> </ul> <h3 id=project-setup>Project setup<a class=headerlink href=#project-setup title="Permanent link">#</a></h3> <p>There are two ways to setup you development environment and project:</p> <ul> <li> <p>[<strong>Recommended</strong>] Using <a href=../cookiecutter/ ><strong>Cookiecutter</strong></a>: This creates the project folder structure, default workflow, automatically installs all the necessary requirements, and creates a <a href=https://code.visualstudio.com/docs/devcontainers/containers target=_blank>devcontainer</a> that can be used with <a href=https://code.visualstudio.com/ target=_blank>Visual Studio Code</a>.</p> </li> <li> <p>Using virtual environment, such as <a href=https://docs.python.org/3/library/venv.html target=_blank>venv</a>, and a Python package manager, such as <a href=https://en.wikipedia.org/wiki/Pip_(package_manager)><strong>pip</strong></a>.</p> </li> </ul> <p>Let's see how to setup project using cookiecutter:</p> <ol> <li> <p>Install Cookiecutter with the following command: <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=go>pip install cookiecutter</span>
</code></pre></div></p> </li> <li> <p>Run the <code>cookiecutter</code> command: <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=go>cookiecutter https://github.com/airtai/cookiecutter-fastagency.git</span>
</code></pre></div></p> </li> <li> <p>Depending on the type of the project, choose the appropriate option in step 3:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:3><input checked=checked id=mesop name=__tabbed_1 type=radio><input id=fastapi--mesop name=__tabbed_1 type=radio><input id=nats--fastapi--mesop name=__tabbed_1 type=radio><div class=tabbed-labels><label for=mesop>Mesop</label><label for=fastapi--mesop>FastAPI + Mesop</label><label for=nats--fastapi--mesop>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=go>[1/4] project_name (My FastAgency App):</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=go>[2/4] project_slug (my_fastagency_app):</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=go>[3/4] Select app_type</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=go>    1 - fastapi+mesop</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=go>    2 - mesop</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=go>    3 - nats+fastapi+mesop</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=go>    Choose from [1/2/3] (1): 2</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=go>[4/4] Select python_version</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=go>    1 - 3.12</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=go>    2 - 3.11</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>    3 - 3.10</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=go>    Choose from [1/2/3] (1):</span>
</code></pre></div> <p>This command installs FastAgency with support for both the Console and Mesop interfaces for AutoGen workflows.</p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=go>[1/4] project_name (My FastAgency App):</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=go>[2/4] project_slug (my_fastagency_app):</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=go>[3/4] Select app_type</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=go>    1 - fastapi+mesop</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=go>    2 - mesop</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=go>    3 - nats+fastapi+mesop</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=go>    Choose from [1/2/3] (1): 1</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=go>[4/4] Select python_version</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=go>    1 - 3.12</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=go>    2 - 3.11</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=go>    3 - 3.10</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=go>    Choose from [1/2/3] (1):</span>
</code></pre></div> <p>This command installs FastAgency with support for both the Console and Mesop interfaces for AutoGen workflows, with FastAPI handling input requests and workflow execution.</p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=go>[1/4] project_name (My FastAgency App):</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=go>[2/4] project_slug (my_fastagency_app):</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=go>[3/4] Select app_type</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=go>    1 - fastapi+mesop</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=go>    2 - mesop</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=go>    3 - nats+fastapi+mesop</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=go>    Choose from [1/2/3] (1): 3</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=go>[4/4] Select python_version</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=go>    1 - 3.12</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=go>    2 - 3.11</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=go>    3 - 3.10</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=go>    Choose from [1/2/3] (1):</span>
</code></pre></div> <p>This command installs FastAgency with support for both the Console and Mesop interfaces for AutoGen workflows, with FastAPI serving input and independent workers communicating over the NATS.io protocol workflows. This is the most scable setup, recommended for large production workloads.</p> </div> </div> </div> </li> <li> <p>Executing the <code>cookiecutter</code> command will create the following file structure:</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:3><input checked=checked id=mesop_1 name=__tabbed_2 type=radio><input id=fastapi--mesop_1 name=__tabbed_2 type=radio><input id=nats--fastapi--mesop_1 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=mesop_1>Mesop</label><label for=fastapi--mesop_1>FastAPI + Mesop</label><label for=nats--fastapi--mesop_1>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=go>my_fastagency_app/</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=go>├── .devcontainer</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=go>│   ├── devcontainer.env</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=go>│   ├── devcontainer.json</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=go>│   ├── docker-compose.yml</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=go>│   └── setup.sh</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=go>├── docker</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=go>│   ├── Dockerfile</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=go>│   └── run_fastagency.sh</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=go>├── fly.toml</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=go>├── .github</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=go>│   └── workflows</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=go>│       └── test.yml</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=go>├── my_fastagency_app</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=go>│   ├── deployment</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=go>│   │   ├── __init__.py</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=go>│   │   └── main.py</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=go>│   ├── __init__.py</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=go>│   ├── local</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=go>│   │   ├── __init__.py</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=go>│   │   └── main_mesop.py</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=go>│   └── workflow.py</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=go>├── pyproject.toml</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=go>├── README.md</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=go>├── scripts</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=go>│   ├── build_docker.sh</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=go>│   ├── deploy_to_fly_io.sh</span>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=go>│   └── run_docker.sh</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=go>└── tests</span>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a><span class=go>    ├── __init__.py</span>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a><span class=go>    ├── conftest.py</span>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a><span class=go>    └── test_workflow.py</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=go>my_fastagency_app/</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=go>├── .devcontainer</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=go>│   ├── devcontainer.env</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=go>│   ├── devcontainer.json</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=go>│   ├── docker-compose.yml</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=go>│   └── setup.sh</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=go>├── docker</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=go>│   ├── Dockerfile</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=go>│   └── run_fastagency.sh</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=go>├── fly.toml</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=go>├── .github</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=go>│   └── workflows</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=go>│       └── test.yml</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=go>├── my_fastagency_app</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=go>│   ├── deployment</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=go>│   │   ├── __init__.py</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=go>│   │   ├── main_1_fastapi.py</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=go>│   │   └── main_2_mesop.py</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=go>│   ├── __init__.py</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=go>│   ├── local</span>
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=go>│   │   ├── __init__.py</span>
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=go>│   │   └── main_mesop.py</span>
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=go>│   └── workflow.py</span>
<a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=go>├── pyproject.toml</span>
<a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=go>├── README.md</span>
<a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=go>├── scripts</span>
<a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=go>│   ├── build_docker.sh</span>
<a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=go>│   ├── deploy_to_fly_io.sh</span>
<a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=go>│   └── run_docker.sh</span>
<a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=go>└── tests</span>
<a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=go>    ├── __init__.py</span>
<a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=go>    ├── conftest.py</span>
<a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a><span class=go>    └── test_workflow.py</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=go>my_fastagency_app/</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=go>├── .devcontainer</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=go>│   ├── devcontainer.env</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=go>│   ├── devcontainer.json</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=go>│   ├── docker-compose.yml</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=go>│   ├── nats_server.conf</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=go>│   └── setup.sh</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=go>├── docker</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=go>│   ├── Dockerfile</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=go>│   └── run_fastagency.sh</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=go>├── fly.toml</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=go>├── .github</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=go>│   └── workflows</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=go>│       └── test.yml</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=go>├── my_fastagency_app</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=go>│   ├── deployment</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=go>│   │   ├── __init__.py</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=go>│   │   ├── main_1_nats.py</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=go>│   │   ├── main_2_fastapi.py</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=go>│   │   └── main_3_mesop.py</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=go>│   ├── __init__.py</span>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=go>│   ├── local</span>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=go>│   │   ├── __init__.py</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=go>│   │   └── main_mesop.py</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=go>│   └── workflow.py</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=go>├── pyproject.toml</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=go>├── README.md</span>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=go>├── scripts</span>
<a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=go>│   ├── build_docker.sh</span>
<a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a><span class=go>│   ├── deploy_to_fly_io.sh</span>
<a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=go>│   └── run_docker.sh</span>
<a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a><span class=go>└── tests</span>
<a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a><span class=go>    ├── __init__.py</span>
<a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=go>    ├── conftest.py</span>
<a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a><span class=go>    └── test_workflow.py</span>
</code></pre></div> </div> </div> </div> </li> <li> <p>To run LLM-based applications, you need an API key for the LLM used. The most commonly used LLM is <a href=https://platform.openai.com/docs/models>OpenAI</a>. To use it, create an <a href=https://openai.com/index/openai-api/ >OpenAI API Key</a> and set it as an environment variable in the terminal using the following command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=go>export OPENAI_API_KEY=openai_api_key_here</span>
</code></pre></div> <p>If you want to use a different LLM provider, follow <a href=https://fastagency.ai/latest/user-guide/runtimes/autogen/using_non_openai_models/ >this guide</a>.</p> <p>Alternatively, you can skip this step and set the LLM API key as an environment variable later in the devcontainer's terminal. If you open the project in <a href=https://code.visualstudio.com/ target=_blank>Visual Studio Code</a> using GUI, you will need to manually set the environment variable in the devcontainer's terminal.</p> </li> <li> <p>Open the generated project in <a href=https://code.visualstudio.com/ target=_blank>Visual Studio Code</a> with the following command: <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=go>code my_fastagency_app</span>
</code></pre></div></p> </li> <li> <p>Once the project is opened, you will get the following option to reopen it in a devcontainer:</p> <p><a class=glightbox href=../getting-started/images/reopen-in-container.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=../getting-started/images/reopen-in-container.png width=600 class=center></a></p> </li> <li> <p>After reopening the project in devcontainer, you can verify that the setup is correct by running the provided tests with the following command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=go>pytest -s</span>
</code></pre></div> <p>You should get the following output if everything is correctly setup. <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=go>=================================== test session starts ===================================</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=go>platform linux -- Python 3.12.7, pytest-8.3.3, pluggy-1.5.0</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=go>rootdir: /workspaces/my_fastagency_app</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=go>configfile: pyproject.toml</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=go>plugins: asyncio-0.24.0, anyio-4.6.2.post1</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=go>asyncio: mode=Mode.STRICT, default_loop_scope=None</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=go>collected 1 item</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=go>tests/test_workflow.py .                                                            [100%]</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=go>==================================== 1 passed in 1.02s ====================================</span>
</code></pre></div></p> <p>Running the test could take up to 30 seconds, depending on latency and throughput of OpenAI (or other LLM providers).</p> </li> </ol> <hr> <h3 id=workflow-development>Workflow Development<a class=headerlink href=#workflow-development title="Permanent link">#</a></h3> <h4 id=define-the-workflow>Define the Workflow<a class=headerlink href=#define-the-workflow title="Permanent link">#</a></h4> <p>You need to define the workflow that your application will use. This is where you specify how the agents interact and what they do. Here's a simple example of a workflow definition:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=kn>from</span> <span class=nn>autogen.agentchat</span> <span class=kn>import</span> <span class=n>ConversableAgent</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>UI</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=kn>from</span> <span class=nn>fastagency.runtimes.autogen</span> <span class=kn>import</span> <span class=n>AutoGenWorkflows</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=n>llm_config</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>    <span class=s2>&quot;config_list&quot;</span><span class=p>:</span> <span class=p>[</span>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>        <span class=p>{</span>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>            <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>            <span class=s2>&quot;api_key&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>        <span class=p>}</span>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a>    <span class=p>],</span>
<a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a>    <span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=mf>0.8</span><span class=p>,</span>
<a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=p>}</span>
<a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a>
<a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=n>wf</span> <span class=o>=</span> <span class=n>AutoGenWorkflows</span><span class=p>()</span>
<a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a>
<a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a>
<a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a><span class=nd>@wf</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;simple_learning&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Student and teacher learning chat&quot;</span><span class=p>)</span>
<a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a><span class=k>def</span> <span class=nf>simple_workflow</span><span class=p>(</span>
<a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a>    <span class=n>ui</span><span class=p>:</span> <span class=n>UI</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a>    <span class=n>initial_message</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>text_input</span><span class=p>(</span>
<a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a>        <span class=n>sender</span><span class=o>=</span><span class=s2>&quot;Workflow&quot;</span><span class=p>,</span>
<a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a>        <span class=n>recipient</span><span class=o>=</span><span class=s2>&quot;User&quot;</span><span class=p>,</span>
<a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a>        <span class=n>prompt</span><span class=o>=</span><span class=s2>&quot;I can help you learn about mathematics. What subject you would like to explore?&quot;</span><span class=p>,</span>
<a id=__codelineno-12-30 name=__codelineno-12-30 href=#__codelineno-12-30></a>    <span class=p>)</span>
<a id=__codelineno-12-31 name=__codelineno-12-31 href=#__codelineno-12-31></a>
<a id=__codelineno-12-32 name=__codelineno-12-32 href=#__codelineno-12-32></a>    <span class=n>student_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-12-33 name=__codelineno-12-33 href=#__codelineno-12-33></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Student_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-12-34 name=__codelineno-12-34 href=#__codelineno-12-34></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a student willing to learn.&quot;</span><span class=p>,</span>
<a id=__codelineno-12-35 name=__codelineno-12-35 href=#__codelineno-12-35></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-12-36 name=__codelineno-12-36 href=#__codelineno-12-36></a>    <span class=p>)</span>
<a id=__codelineno-12-37 name=__codelineno-12-37 href=#__codelineno-12-37></a>    <span class=n>teacher_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-12-38 name=__codelineno-12-38 href=#__codelineno-12-38></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Teacher_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-12-39 name=__codelineno-12-39 href=#__codelineno-12-39></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a math teacher.&quot;</span><span class=p>,</span>
<a id=__codelineno-12-40 name=__codelineno-12-40 href=#__codelineno-12-40></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-12-41 name=__codelineno-12-41 href=#__codelineno-12-41></a>    <span class=p>)</span>
<a id=__codelineno-12-42 name=__codelineno-12-42 href=#__codelineno-12-42></a>
<a id=__codelineno-12-43 name=__codelineno-12-43 href=#__codelineno-12-43></a>    <span class=n>chat_result</span> <span class=o>=</span> <span class=n>student_agent</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span>
<a id=__codelineno-12-44 name=__codelineno-12-44 href=#__codelineno-12-44></a>        <span class=n>teacher_agent</span><span class=p>,</span>
<a id=__codelineno-12-45 name=__codelineno-12-45 href=#__codelineno-12-45></a>        <span class=n>message</span><span class=o>=</span><span class=n>initial_message</span><span class=p>,</span>
<a id=__codelineno-12-46 name=__codelineno-12-46 href=#__codelineno-12-46></a>        <span class=n>summary_method</span><span class=o>=</span><span class=s2>&quot;reflection_with_llm&quot;</span><span class=p>,</span>
<a id=__codelineno-12-47 name=__codelineno-12-47 href=#__codelineno-12-47></a>        <span class=n>max_turns</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-12-48 name=__codelineno-12-48 href=#__codelineno-12-48></a>    <span class=p>)</span>
<a id=__codelineno-12-49 name=__codelineno-12-49 href=#__codelineno-12-49></a>
<a id=__codelineno-12-50 name=__codelineno-12-50 href=#__codelineno-12-50></a>    <span class=k>return</span> <span class=n>chat_result</span><span class=o>.</span><span class=n>summary</span>  <span class=c1># type: ignore[no-any-return]</span>
</code></pre></div> <p>This code snippet sets up a simple learning chat between a student and a teacher. You define the agents and how they should interact, specifying how the conversation should be summarized.</p> <h4 id=run-and-debug-the-workflow>Run and Debug the Workflow<a class=headerlink href=#run-and-debug-the-workflow title="Permanent link">#</a></h4> <p>To ensure that the workflow we have defined is working properly, we can test it locally using MesopUI. The code below imports the defined workflow and sets up MesopUI:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=kn>from</span> <span class=nn>fastagency.ui.mesop</span> <span class=kn>import</span> <span class=n>MesopUI</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>MesopUI</span><span class=p>(),</span> <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Learning Chat&quot;</span><span class=p>)</span>
</code></pre></div> <p>Run MesopUI locally with the following command:</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=linuxmacos name=__tabbed_3 type=radio><input id=windows name=__tabbed_3 type=radio><div class=tabbed-labels><label for=linuxmacos>Linux/MacOS</label><label for=windows>Windows</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="admonition note"> <p class=admonition-title>Terminal</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=go>gunicorn main_mesop:app</span>
</code></pre></div> </div> </div> <div class=tabbed-block> <div class="admonition note"> <p class=admonition-title>Terminal</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=go>waitress-serve --listen=0.0.0.0:8000 main_mesop:app</span>
</code></pre></div> </div> </div> </div> </div> <p>Open the MesopUI URL <a href=http://localhost:8000>http://localhost:8000</a> in your browser. You can now use the graphical user interface to start, run, test and debug the autogen workflow manually.</p> <h4 id=run-workflow-tests>Run Workflow Tests<a class=headerlink href=#run-workflow-tests title="Permanent link">#</a></h4> <p>We can also use pytest to test the autogen workflow automatically, instead of manually testing it using MesopUI.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>from</span> <span class=nn>unittest.mock</span> <span class=kn>import</span> <span class=n>MagicMock</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=kn>from</span> <span class=nn>uuid</span> <span class=kn>import</span> <span class=n>uuid4</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=kn>import</span> <span class=nn>pytest</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=kn>from</span> <span class=nn>fastagency.ui.console</span> <span class=kn>import</span> <span class=n>ConsoleUI</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=k>class</span> <span class=nc>InputMock</span><span class=p>:</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>responses</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the InputMock.&quot;&quot;&quot;</span>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>responses</span> <span class=o>=</span> <span class=n>responses</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mock</span> <span class=o>=</span> <span class=n>MagicMock</span><span class=p>()</span>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mock</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>responses</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=k>def</span> <span class=nf>test_workflow</span><span class=p>(</span><span class=n>monkeypatch</span><span class=p>:</span> <span class=n>pytest</span><span class=o>.</span><span class=n>MonkeyPatch</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>    <span class=n>monkeypatch</span><span class=o>.</span><span class=n>setattr</span><span class=p>(</span><span class=s2>&quot;builtins.input&quot;</span><span class=p>,</span> <span class=n>InputMock</span><span class=p>([</span><span class=s2>&quot;&quot;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>5</span><span class=p>))</span>
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;simple_learning&quot;</span><span class=p>,</span>
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a>        <span class=n>ui</span><span class=o>=</span><span class=n>ConsoleUI</span><span class=p>()</span><span class=o>.</span><span class=n>create_workflow_ui</span><span class=p>(</span><span class=n>workflow_uuid</span><span class=o>=</span><span class=n>uuid4</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span><span class=p>),</span>
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a>    <span class=p>)</span>
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>
<a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a>    <span class=k>assert</span> <span class=n>result</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</code></pre></div> <p>Run the test with the following command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=go>pytest</span>
</code></pre></div> <p>Running the test could take up to 30 seconds, depending on latency and throughput of OpenAI (or other LLM providers).</p> <h3 id=workflow-deployment>Workflow Deployment<a class=headerlink href=#workflow-deployment title="Permanent link">#</a></h3> <h4 id=imports>Imports<a class=headerlink href=#imports title="Permanent link">#</a></h4> <p>Depending on the interface you choose, you'll need to import different modules. These imports set up the necessary components for your application:</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:4><input checked=checked id=console name=__tabbed_4 type=radio><input id=mesop_2 name=__tabbed_4 type=radio><input id=fastapi--mesop_2 name=__tabbed_4 type=radio><input id=nats--fastapi--mesop_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=console>Console</label><label for=mesop_2>Mesop</label><label for=fastapi--mesop_2>FastAPI + Mesop</label><label for=nats--fastapi--mesop_2>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=hll><span class=kn>from</span> <span class=nn>fastagency.ui.console</span> <span class=kn>import</span> <span class=n>ConsoleUI</span>
</span><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
</code></pre></div> <p>For Console applications, import <code>ConsoleUI</code> to handle command-line input and output.</p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=hll><span class=kn>from</span> <span class=nn>fastagency.ui.mesop</span> <span class=kn>import</span> <span class=n>MesopUI</span>
</span><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
</code></pre></div> <p>For Mesop applications, import <code>MesopUI</code> to integrate with the Mesop web interface.</p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=hll><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
</span><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
</code></pre></div> <p>For FastAPI applications, import <code>FastAPIAdapter</code> to expose your workflows as REST API.</p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=hll><span class=kn>from</span> <span class=nn>fastagency.adapters.nats</span> <span class=kn>import</span> <span class=n>NatsAdapter</span>
</span><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
</code></pre></div> </div> </div> </div> <h4 id=define-fastagency-application>Define FastAgency Application<a class=headerlink href=#define-fastagency-application title="Permanent link">#</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=5:4><input checked=checked id=console_1 name=__tabbed_5 type=radio><input id=mesop_3 name=__tabbed_5 type=radio><input id=fastapi--mesop_3 name=__tabbed_5 type=radio><input id=nats--fastapi--mesop_3 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=console_1>Console</label><label for=mesop_3>Mesop</label><label for=fastapi--mesop_3>FastAPI + Mesop</label><label for=nats--fastapi--mesop_3>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>Next, define your FastAgency application. This ties together your workflow and the interface you chose:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=hll><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>ConsoleUI</span><span class=p>(),</span> <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Learning Chat&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>For Console applications, use <code>ConsoleUI</code> to handle user interaction via the command line.</p> </div> <div class=tabbed-block> <p>Next, define your FastAgency application. This ties together your workflow and the interface you chose:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=hll><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>MesopUI</span><span class=p>(),</span> <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Learning Chat&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>For Mesop applications, use <code>MesopUI</code> to enable web-based interactions.</p> </div> <div class=tabbed-block> <p>In the case of FastAPI application, we will create an <code>FastAPIAdapter</code> and then include a router to the <code>FastAPI</code> application. The adapter will have all REST and Websocket routes for communicating with a client.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=hll><span class=n>adapter</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>)</span>
</span><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=hll><span class=n>app</span><span class=o>.</span><span class=n>include_router</span><span class=p>(</span><span class=n>adapter</span><span class=o>.</span><span class=n>router</span><span class=p>)</span>
</span></code></pre></div> </div> <div class=tabbed-block> <p>In the case of NATS.io application, we will create an <code>NatsAdapter</code> and then add it to a <code>FastAPI</code> application using the <code>lifespan</code> parameter. The adapter will have all REST and Websocket routes for communicating with a client.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=n>nats_url</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;NATS_URL&quot;</span><span class=p>,</span> <span class=s2>&quot;nats://localhost:4222&quot;</span><span class=p>)</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=n>user</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;fastagency&quot;</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=n>password</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;FASTAGENCY_NATS_PASSWORD&quot;</span><span class=p>,</span> <span class=s2>&quot;fastagency_nats_password&quot;</span><span class=p>)</span>  <span class=c1># type: ignore[assignment]</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=hll><span class=n>adapter</span> <span class=o>=</span> <span class=n>NatsAdapter</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>,</span> <span class=n>nats_url</span><span class=o>=</span><span class=n>nats_url</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>user</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=hll><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>lifespan</span><span class=o>=</span><span class=n>adapter</span><span class=o>.</span><span class=n>lifespan</span><span class=p>)</span>
</span></code></pre></div> <p>The <code>NatsAdapter</code> requires a running NATS server. The easiest way to start the NATS server is by using <a href=https://www.docker.com/ target=_blank>Docker</a>. FastAgency uses the <a href=https://docs.nats.io/nats-concepts/jetstream target=_blank>JetStream</a> feature of NATS and also utilizes authentication.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=hll><span class=n>port</span><span class=p>:</span> <span class=mi>4222</span>
</span><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=hll><span class=n>monitor_port</span><span class=p>:</span> <span class=mi>8222</span>
</span><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=n>websocket</span> <span class=p>{</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=hll>    <span class=n>port</span><span class=p>:</span> <span class=mi>9222</span>
</span><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>    <span class=n>no_tls</span><span class=p>:</span> <span class=n>true</span>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>    <span class=n>compress</span><span class=p>:</span> <span class=n>true</span>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=p>}</span>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=hll><span class=n>jetstream</span> <span class=p>{}</span>
</span><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=n>accounts</span> <span class=p>{</span>
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>  <span class=n>AUTH</span> <span class=p>{</span>
<a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a>    <span class=n>jetstream</span><span class=p>:</span> <span class=n>enabled</span>
<a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a>    <span class=n>users</span><span class=p>:</span> <span class=p>[</span>
<a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=hll>      <span class=p>{</span> <span class=n>user</span><span class=p>:</span> <span class=n>fastagency</span><span class=p>,</span> <span class=n>password</span><span class=p>:</span> <span class=err>$</span><span class=n>FASTAGENCY_NATS_PASSWORD</span> <span class=p>}</span>
</span><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a>    <span class=p>]</span>
<a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>  <span class=p>}</span>
<a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a>  <span class=n>SYS</span> <span class=p>{}</span>
<a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a><span class=p>}</span>
<a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a>
<a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=n>system_account</span><span class=p>:</span> <span class=n>SYS</span>
</code></pre></div> <p>In the above NATS configuration, we define a user called <code>fastagency</code>, and its password is read from the environment variable <code>FASTAGENCY_NATS_PASSWORD</code>. We also enable JetStream in NATS and configure NATS to serve via the appropriate ports.</p> </div> </div> </div> <h4 id=adapter-chaining>Adapter Chaining<a class=headerlink href=#adapter-chaining title="Permanent link">#</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=6:4><input checked=checked id=console_2 name=__tabbed_6 type=radio><input id=mesop_4 name=__tabbed_6 type=radio><input id=fastapi--mesop_4 name=__tabbed_6 type=radio><input id=nats--fastapi--mesop_4 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=console_2>Console</label><label for=mesop_4>Mesop</label><label for=fastapi--mesop_4>FastAPI + Mesop</label><label for=nats--fastapi--mesop_4>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>Not applicable for this setup as there are no adapters used.</p> </div> <div class=tabbed-block> <p>Not applicable for this setup as there are no adapters used.</p> </div> <div class=tabbed-block> <p>There is an additional specification file for an application using <code>MesopUI</code> to connect to the <code>FastAPIAdapter</code></p> <div class="admonition note"> <p class=admonition-title>main_2_mesop.py</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=kn>from</span> <span class=nn>fastagency.app</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=kn>from</span> <span class=nn>fastagency.ui.mesop</span> <span class=kn>import</span> <span class=n>MesopUI</span>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=n>fastapi_url</span> <span class=o>=</span> <span class=s2>&quot;http://localhost:8008&quot;</span>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=hll><span class=n>provider</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=o>.</span><span class=n>create_provider</span><span class=p>(</span>
</span><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=hll>    <span class=n>fastapi_url</span><span class=o>=</span><span class=n>fastapi_url</span><span class=p>,</span>
</span><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=hll><span class=p>)</span>
</span><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>
<a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=hll><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>provider</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>MesopUI</span><span class=p>())</span>
</span></code></pre></div> </div> </div> <div class=tabbed-block> <p>Above, we created NATS.io provider that will start brokers waiting to consume initiate workflow messages from the message broker. Now, we create FastAPI service interacting with NATS.io provider:</p> <div class="admonition note"> <p class=admonition-title>main_2_fastapi.py</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=kn>from</span> <span class=nn>os</span> <span class=kn>import</span> <span class=n>environ</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=kn>from</span> <span class=nn>fastagency.adapters.nats</span> <span class=kn>import</span> <span class=n>NatsAdapter</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=n>nats_url</span> <span class=o>=</span> <span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;NATS_URL&quot;</span><span class=p>,</span> <span class=s2>&quot;nats://localhost:4222&quot;</span><span class=p>)</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=n>nats_user</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;fastagency&quot;</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=n>nats_password</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;FASTAGENCY_NATS_PASSWORD&quot;</span><span class=p>,</span> <span class=s2>&quot;fastagency_nats_password&quot;</span><span class=p>)</span>  <span class=c1># type: ignore[assignment]</span>
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=n>provider</span> <span class=o>=</span> <span class=n>NatsAdapter</span><span class=o>.</span><span class=n>create_provider</span><span class=p>(</span>
<a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>    <span class=n>nats_url</span><span class=o>=</span><span class=n>nats_url</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>nats_user</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>nats_password</span>
<a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=p>)</span>
<a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>
<a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=hll><span class=n>adapter</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=p>(</span>
</span><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a><span class=hll>    <span class=n>provider</span><span class=o>=</span><span class=n>provider</span><span class=p>,</span>
</span><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a><span class=hll><span class=p>)</span>
</span><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>
<a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a><span class=c1># app = FastAPI(lifespan=provider.lifespan)</span>
<a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a><span class=hll><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a><span class=hll><span class=n>app</span><span class=o>.</span><span class=n>include_router</span><span class=p>(</span><span class=n>adapter</span><span class=o>.</span><span class=n>router</span><span class=p>)</span>
</span></code></pre></div> </div> <p>Finally, we create Mesop app communicating with the FastAPI application:</p> <div class="admonition note"> <p class=admonition-title>main_3_mesop.py</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=kn>from</span> <span class=nn>fastagency.app</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=kn>from</span> <span class=nn>fastagency.ui.mesop</span> <span class=kn>import</span> <span class=n>MesopUI</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=n>fastapi_url</span> <span class=o>=</span> <span class=s2>&quot;http://localhost:8008&quot;</span>
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=hll><span class=n>provider</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=o>.</span><span class=n>create_provider</span><span class=p>(</span>
</span><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=hll>    <span class=n>fastapi_url</span><span class=o>=</span><span class=n>fastapi_url</span><span class=p>,</span>
</span><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=hll><span class=p>)</span>
</span><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>
<a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=hll><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>provider</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>MesopUI</span><span class=p>())</span>
</span></code></pre></div> </div> </div> </div> </div> <h3 id=complete-application-code>Complete Application Code<a class=headerlink href=#complete-application-code title="Permanent link">#</a></h3> <p>Please copy and paste the following code into the same folder, using the file names exactly as mentioned below.</p> <div class="tabbed-set tabbed-alternate" data-tabs=7:4><input checked=checked id=console_3 name=__tabbed_7 type=radio><input id=mesop_5 name=__tabbed_7 type=radio><input id=fastapi--mesop_5 name=__tabbed_7 type=radio><input id=nats--fastapi--mesop_5 name=__tabbed_7 type=radio><div class=tabbed-labels><label for=console_3>Console</label><label for=mesop_5>Mesop</label><label for=fastapi--mesop_5>FastAPI + Mesop</label><label for=nats--fastapi--mesop_5>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><details> <summary>workflow.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=kn>from</span> <span class=nn>autogen.agentchat</span> <span class=kn>import</span> <span class=n>ConversableAgent</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>UI</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=kn>from</span> <span class=nn>fastagency.runtimes.autogen</span> <span class=kn>import</span> <span class=n>AutoGenWorkflows</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=n>llm_config</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>    <span class=s2>&quot;config_list&quot;</span><span class=p>:</span> <span class=p>[</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>        <span class=p>{</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>            <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>            <span class=s2>&quot;api_key&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>        <span class=p>}</span>
<a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a>    <span class=p>],</span>
<a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a>    <span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=mf>0.8</span><span class=p>,</span>
<a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=p>}</span>
<a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a>
<a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a><span class=n>wf</span> <span class=o>=</span> <span class=n>AutoGenWorkflows</span><span class=p>()</span>
<a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a>
<a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a>
<a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a><span class=nd>@wf</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;simple_learning&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Student and teacher learning chat&quot;</span><span class=p>)</span>
<a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a><span class=k>def</span> <span class=nf>simple_workflow</span><span class=p>(</span>
<a id=__codelineno-30-24 name=__codelineno-30-24 href=#__codelineno-30-24></a>    <span class=n>ui</span><span class=p>:</span> <span class=n>UI</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-30-25 name=__codelineno-30-25 href=#__codelineno-30-25></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-30-26 name=__codelineno-30-26 href=#__codelineno-30-26></a>    <span class=n>initial_message</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>text_input</span><span class=p>(</span>
<a id=__codelineno-30-27 name=__codelineno-30-27 href=#__codelineno-30-27></a>        <span class=n>sender</span><span class=o>=</span><span class=s2>&quot;Workflow&quot;</span><span class=p>,</span>
<a id=__codelineno-30-28 name=__codelineno-30-28 href=#__codelineno-30-28></a>        <span class=n>recipient</span><span class=o>=</span><span class=s2>&quot;User&quot;</span><span class=p>,</span>
<a id=__codelineno-30-29 name=__codelineno-30-29 href=#__codelineno-30-29></a>        <span class=n>prompt</span><span class=o>=</span><span class=s2>&quot;I can help you learn about mathematics. What subject you would like to explore?&quot;</span><span class=p>,</span>
<a id=__codelineno-30-30 name=__codelineno-30-30 href=#__codelineno-30-30></a>    <span class=p>)</span>
<a id=__codelineno-30-31 name=__codelineno-30-31 href=#__codelineno-30-31></a>
<a id=__codelineno-30-32 name=__codelineno-30-32 href=#__codelineno-30-32></a>    <span class=n>student_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-30-33 name=__codelineno-30-33 href=#__codelineno-30-33></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Student_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-30-34 name=__codelineno-30-34 href=#__codelineno-30-34></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a student willing to learn.&quot;</span><span class=p>,</span>
<a id=__codelineno-30-35 name=__codelineno-30-35 href=#__codelineno-30-35></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-30-36 name=__codelineno-30-36 href=#__codelineno-30-36></a>    <span class=p>)</span>
<a id=__codelineno-30-37 name=__codelineno-30-37 href=#__codelineno-30-37></a>    <span class=n>teacher_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-30-38 name=__codelineno-30-38 href=#__codelineno-30-38></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Teacher_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-30-39 name=__codelineno-30-39 href=#__codelineno-30-39></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a math teacher.&quot;</span><span class=p>,</span>
<a id=__codelineno-30-40 name=__codelineno-30-40 href=#__codelineno-30-40></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-30-41 name=__codelineno-30-41 href=#__codelineno-30-41></a>    <span class=p>)</span>
<a id=__codelineno-30-42 name=__codelineno-30-42 href=#__codelineno-30-42></a>
<a id=__codelineno-30-43 name=__codelineno-30-43 href=#__codelineno-30-43></a>    <span class=n>chat_result</span> <span class=o>=</span> <span class=n>student_agent</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span>
<a id=__codelineno-30-44 name=__codelineno-30-44 href=#__codelineno-30-44></a>        <span class=n>teacher_agent</span><span class=p>,</span>
<a id=__codelineno-30-45 name=__codelineno-30-45 href=#__codelineno-30-45></a>        <span class=n>message</span><span class=o>=</span><span class=n>initial_message</span><span class=p>,</span>
<a id=__codelineno-30-46 name=__codelineno-30-46 href=#__codelineno-30-46></a>        <span class=n>summary_method</span><span class=o>=</span><span class=s2>&quot;reflection_with_llm&quot;</span><span class=p>,</span>
<a id=__codelineno-30-47 name=__codelineno-30-47 href=#__codelineno-30-47></a>        <span class=n>max_turns</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-30-48 name=__codelineno-30-48 href=#__codelineno-30-48></a>    <span class=p>)</span>
<a id=__codelineno-30-49 name=__codelineno-30-49 href=#__codelineno-30-49></a>
<a id=__codelineno-30-50 name=__codelineno-30-50 href=#__codelineno-30-50></a>    <span class=k>return</span> <span class=n>chat_result</span><span class=o>.</span><span class=n>summary</span>  <span class=c1># type: ignore[no-any-return]</span>
</code></pre></div> </details></p> <p><details> <summary>main.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=kn>from</span> <span class=nn>fastagency.ui.console</span> <span class=kn>import</span> <span class=n>ConsoleUI</span>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>ConsoleUI</span><span class=p>(),</span> <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Learning Chat&quot;</span><span class=p>)</span>
</code></pre></div> </details></p> </div> <div class=tabbed-block> <p><details> <summary>workflow.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=kn>from</span> <span class=nn>autogen.agentchat</span> <span class=kn>import</span> <span class=n>ConversableAgent</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>UI</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=kn>from</span> <span class=nn>fastagency.runtimes.autogen</span> <span class=kn>import</span> <span class=n>AutoGenWorkflows</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a><span class=n>llm_config</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>    <span class=s2>&quot;config_list&quot;</span><span class=p>:</span> <span class=p>[</span>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>        <span class=p>{</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>            <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a>            <span class=s2>&quot;api_key&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>        <span class=p>}</span>
<a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a>    <span class=p>],</span>
<a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a>    <span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=mf>0.8</span><span class=p>,</span>
<a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a><span class=p>}</span>
<a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a>
<a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a><span class=n>wf</span> <span class=o>=</span> <span class=n>AutoGenWorkflows</span><span class=p>()</span>
<a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a>
<a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a>
<a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a><span class=nd>@wf</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;simple_learning&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Student and teacher learning chat&quot;</span><span class=p>)</span>
<a id=__codelineno-32-23 name=__codelineno-32-23 href=#__codelineno-32-23></a><span class=k>def</span> <span class=nf>simple_workflow</span><span class=p>(</span>
<a id=__codelineno-32-24 name=__codelineno-32-24 href=#__codelineno-32-24></a>    <span class=n>ui</span><span class=p>:</span> <span class=n>UI</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-32-25 name=__codelineno-32-25 href=#__codelineno-32-25></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-32-26 name=__codelineno-32-26 href=#__codelineno-32-26></a>    <span class=n>initial_message</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>text_input</span><span class=p>(</span>
<a id=__codelineno-32-27 name=__codelineno-32-27 href=#__codelineno-32-27></a>        <span class=n>sender</span><span class=o>=</span><span class=s2>&quot;Workflow&quot;</span><span class=p>,</span>
<a id=__codelineno-32-28 name=__codelineno-32-28 href=#__codelineno-32-28></a>        <span class=n>recipient</span><span class=o>=</span><span class=s2>&quot;User&quot;</span><span class=p>,</span>
<a id=__codelineno-32-29 name=__codelineno-32-29 href=#__codelineno-32-29></a>        <span class=n>prompt</span><span class=o>=</span><span class=s2>&quot;I can help you learn about mathematics. What subject you would like to explore?&quot;</span><span class=p>,</span>
<a id=__codelineno-32-30 name=__codelineno-32-30 href=#__codelineno-32-30></a>    <span class=p>)</span>
<a id=__codelineno-32-31 name=__codelineno-32-31 href=#__codelineno-32-31></a>
<a id=__codelineno-32-32 name=__codelineno-32-32 href=#__codelineno-32-32></a>    <span class=n>student_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-32-33 name=__codelineno-32-33 href=#__codelineno-32-33></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Student_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-32-34 name=__codelineno-32-34 href=#__codelineno-32-34></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a student willing to learn.&quot;</span><span class=p>,</span>
<a id=__codelineno-32-35 name=__codelineno-32-35 href=#__codelineno-32-35></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-32-36 name=__codelineno-32-36 href=#__codelineno-32-36></a>    <span class=p>)</span>
<a id=__codelineno-32-37 name=__codelineno-32-37 href=#__codelineno-32-37></a>    <span class=n>teacher_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-32-38 name=__codelineno-32-38 href=#__codelineno-32-38></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Teacher_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-32-39 name=__codelineno-32-39 href=#__codelineno-32-39></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a math teacher.&quot;</span><span class=p>,</span>
<a id=__codelineno-32-40 name=__codelineno-32-40 href=#__codelineno-32-40></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-32-41 name=__codelineno-32-41 href=#__codelineno-32-41></a>    <span class=p>)</span>
<a id=__codelineno-32-42 name=__codelineno-32-42 href=#__codelineno-32-42></a>
<a id=__codelineno-32-43 name=__codelineno-32-43 href=#__codelineno-32-43></a>    <span class=n>chat_result</span> <span class=o>=</span> <span class=n>student_agent</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span>
<a id=__codelineno-32-44 name=__codelineno-32-44 href=#__codelineno-32-44></a>        <span class=n>teacher_agent</span><span class=p>,</span>
<a id=__codelineno-32-45 name=__codelineno-32-45 href=#__codelineno-32-45></a>        <span class=n>message</span><span class=o>=</span><span class=n>initial_message</span><span class=p>,</span>
<a id=__codelineno-32-46 name=__codelineno-32-46 href=#__codelineno-32-46></a>        <span class=n>summary_method</span><span class=o>=</span><span class=s2>&quot;reflection_with_llm&quot;</span><span class=p>,</span>
<a id=__codelineno-32-47 name=__codelineno-32-47 href=#__codelineno-32-47></a>        <span class=n>max_turns</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-32-48 name=__codelineno-32-48 href=#__codelineno-32-48></a>    <span class=p>)</span>
<a id=__codelineno-32-49 name=__codelineno-32-49 href=#__codelineno-32-49></a>
<a id=__codelineno-32-50 name=__codelineno-32-50 href=#__codelineno-32-50></a>    <span class=k>return</span> <span class=n>chat_result</span><span class=o>.</span><span class=n>summary</span>  <span class=c1># type: ignore[no-any-return]</span>
</code></pre></div> </details></p> <p><details> <summary>main.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=kn>from</span> <span class=nn>fastagency.ui.mesop</span> <span class=kn>import</span> <span class=n>MesopUI</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>MesopUI</span><span class=p>(),</span> <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Learning Chat&quot;</span><span class=p>)</span>
</code></pre></div> </details></p> </div> <div class=tabbed-block> <p><details> <summary>workflow.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=kn>from</span> <span class=nn>autogen.agentchat</span> <span class=kn>import</span> <span class=n>ConversableAgent</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>UI</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=kn>from</span> <span class=nn>fastagency.runtimes.autogen</span> <span class=kn>import</span> <span class=n>AutoGenWorkflows</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a><span class=n>llm_config</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>    <span class=s2>&quot;config_list&quot;</span><span class=p>:</span> <span class=p>[</span>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>        <span class=p>{</span>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>            <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a>            <span class=s2>&quot;api_key&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>        <span class=p>}</span>
<a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>    <span class=p>],</span>
<a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>    <span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=mf>0.8</span><span class=p>,</span>
<a id=__codelineno-34-17 name=__codelineno-34-17 href=#__codelineno-34-17></a><span class=p>}</span>
<a id=__codelineno-34-18 name=__codelineno-34-18 href=#__codelineno-34-18></a>
<a id=__codelineno-34-19 name=__codelineno-34-19 href=#__codelineno-34-19></a><span class=n>wf</span> <span class=o>=</span> <span class=n>AutoGenWorkflows</span><span class=p>()</span>
<a id=__codelineno-34-20 name=__codelineno-34-20 href=#__codelineno-34-20></a>
<a id=__codelineno-34-21 name=__codelineno-34-21 href=#__codelineno-34-21></a>
<a id=__codelineno-34-22 name=__codelineno-34-22 href=#__codelineno-34-22></a><span class=nd>@wf</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;simple_learning&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Student and teacher learning chat&quot;</span><span class=p>)</span>
<a id=__codelineno-34-23 name=__codelineno-34-23 href=#__codelineno-34-23></a><span class=k>def</span> <span class=nf>simple_workflow</span><span class=p>(</span><span class=n>ui</span><span class=p>:</span> <span class=n>UI</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-34-24 name=__codelineno-34-24 href=#__codelineno-34-24></a>    <span class=n>initial_message</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>text_input</span><span class=p>(</span>
<a id=__codelineno-34-25 name=__codelineno-34-25 href=#__codelineno-34-25></a>        <span class=n>sender</span><span class=o>=</span><span class=s2>&quot;Workflow&quot;</span><span class=p>,</span>
<a id=__codelineno-34-26 name=__codelineno-34-26 href=#__codelineno-34-26></a>        <span class=n>recipient</span><span class=o>=</span><span class=s2>&quot;User&quot;</span><span class=p>,</span>
<a id=__codelineno-34-27 name=__codelineno-34-27 href=#__codelineno-34-27></a>        <span class=n>prompt</span><span class=o>=</span><span class=s2>&quot;I can help you learn about mathematics. What subject you would like to explore?&quot;</span><span class=p>,</span>
<a id=__codelineno-34-28 name=__codelineno-34-28 href=#__codelineno-34-28></a>    <span class=p>)</span>
<a id=__codelineno-34-29 name=__codelineno-34-29 href=#__codelineno-34-29></a>
<a id=__codelineno-34-30 name=__codelineno-34-30 href=#__codelineno-34-30></a>    <span class=n>student_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-34-31 name=__codelineno-34-31 href=#__codelineno-34-31></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Student_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-34-32 name=__codelineno-34-32 href=#__codelineno-34-32></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a student willing to learn.&quot;</span><span class=p>,</span>
<a id=__codelineno-34-33 name=__codelineno-34-33 href=#__codelineno-34-33></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-34-34 name=__codelineno-34-34 href=#__codelineno-34-34></a>        <span class=c1># human_input_mode=&quot;ALWAYS&quot;,</span>
<a id=__codelineno-34-35 name=__codelineno-34-35 href=#__codelineno-34-35></a>    <span class=p>)</span>
<a id=__codelineno-34-36 name=__codelineno-34-36 href=#__codelineno-34-36></a>    <span class=n>teacher_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-34-37 name=__codelineno-34-37 href=#__codelineno-34-37></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Teacher_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-34-38 name=__codelineno-34-38 href=#__codelineno-34-38></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a math teacher.&quot;</span><span class=p>,</span>
<a id=__codelineno-34-39 name=__codelineno-34-39 href=#__codelineno-34-39></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-34-40 name=__codelineno-34-40 href=#__codelineno-34-40></a>        <span class=c1># human_input_mode=&quot;ALWAYS&quot;,</span>
<a id=__codelineno-34-41 name=__codelineno-34-41 href=#__codelineno-34-41></a>    <span class=p>)</span>
<a id=__codelineno-34-42 name=__codelineno-34-42 href=#__codelineno-34-42></a>
<a id=__codelineno-34-43 name=__codelineno-34-43 href=#__codelineno-34-43></a>    <span class=n>chat_result</span> <span class=o>=</span> <span class=n>student_agent</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span>
<a id=__codelineno-34-44 name=__codelineno-34-44 href=#__codelineno-34-44></a>        <span class=n>teacher_agent</span><span class=p>,</span>
<a id=__codelineno-34-45 name=__codelineno-34-45 href=#__codelineno-34-45></a>        <span class=n>message</span><span class=o>=</span><span class=n>initial_message</span><span class=p>,</span>
<a id=__codelineno-34-46 name=__codelineno-34-46 href=#__codelineno-34-46></a>        <span class=n>summary_method</span><span class=o>=</span><span class=s2>&quot;reflection_with_llm&quot;</span><span class=p>,</span>
<a id=__codelineno-34-47 name=__codelineno-34-47 href=#__codelineno-34-47></a>        <span class=n>max_turns</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
<a id=__codelineno-34-48 name=__codelineno-34-48 href=#__codelineno-34-48></a>    <span class=p>)</span>
<a id=__codelineno-34-49 name=__codelineno-34-49 href=#__codelineno-34-49></a>
<a id=__codelineno-34-50 name=__codelineno-34-50 href=#__codelineno-34-50></a>    <span class=k>return</span> <span class=n>chat_result</span><span class=o>.</span><span class=n>summary</span>  <span class=c1># type: ignore[no-any-return]</span>
</code></pre></div> </details></p> <p><details> <summary>main_1_fastapi.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
<a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>
<a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>
<a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=n>adapter</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>)</span>
<a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a>
<a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
<a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a><span class=n>app</span><span class=o>.</span><span class=n>include_router</span><span class=p>(</span><span class=n>adapter</span><span class=o>.</span><span class=n>router</span><span class=p>)</span>
<a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a>
<a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a>
<a id=__codelineno-35-14 name=__codelineno-35-14 href=#__codelineno-35-14></a><span class=c1># this is optional, but we would like to see the list of available workflows</span>
<a id=__codelineno-35-15 name=__codelineno-35-15 href=#__codelineno-35-15></a><span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
<a id=__codelineno-35-16 name=__codelineno-35-16 href=#__codelineno-35-16></a><span class=k>def</span> <span class=nf>read_root</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]:</span>
<a id=__codelineno-35-17 name=__codelineno-35-17 href=#__codelineno-35-17></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;Workflows&quot;</span><span class=p>:</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>wf</span><span class=o>.</span><span class=n>get_description</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>wf</span><span class=o>.</span><span class=n>names</span><span class=p>}}</span>
<a id=__codelineno-35-18 name=__codelineno-35-18 href=#__codelineno-35-18></a>
<a id=__codelineno-35-19 name=__codelineno-35-19 href=#__codelineno-35-19></a>
<a id=__codelineno-35-20 name=__codelineno-35-20 href=#__codelineno-35-20></a><span class=c1># start the provider with the following command</span>
<a id=__codelineno-35-21 name=__codelineno-35-21 href=#__codelineno-35-21></a><span class=c1># uvicorn main_1_fastapi:app --host 0.0.0.0 --port 8008 --reload</span>
</code></pre></div> </details></p> <p><details> <summary>main_2_mesop.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=kn>from</span> <span class=nn>fastagency.app</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=kn>from</span> <span class=nn>fastagency.ui.mesop</span> <span class=kn>import</span> <span class=n>MesopUI</span>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=n>fastapi_url</span> <span class=o>=</span> <span class=s2>&quot;http://localhost:8008&quot;</span>
<a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>
<a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=n>provider</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=o>.</span><span class=n>create_provider</span><span class=p>(</span>
<a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>    <span class=n>fastapi_url</span><span class=o>=</span><span class=n>fastapi_url</span><span class=p>,</span>
<a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=p>)</span>
<a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>
<a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>provider</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>MesopUI</span><span class=p>())</span>
<a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>
<a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a><span class=c1># start the provider with the following command</span>
<a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a><span class=c1># gunicorn main_2_mesop:app -b 0.0.0.0:8888 --reload</span>
</code></pre></div> </details></p> </div> <div class=tabbed-block> <p><details> <summary>nats-server.conf</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=n>port</span><span class=p>:</span> <span class=mi>4222</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=n>monitor_port</span><span class=p>:</span> <span class=mi>8222</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=n>websocket</span> <span class=p>{</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>    <span class=n>port</span><span class=p>:</span> <span class=mi>9222</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>    <span class=n>no_tls</span><span class=p>:</span> <span class=n>true</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>    <span class=n>compress</span><span class=p>:</span> <span class=n>true</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a><span class=p>}</span>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a><span class=n>jetstream</span> <span class=p>{}</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a><span class=n>accounts</span> <span class=p>{</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>  <span class=n>AUTH</span> <span class=p>{</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>    <span class=n>jetstream</span><span class=p>:</span> <span class=n>enabled</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>    <span class=n>users</span><span class=p>:</span> <span class=p>[</span>
<a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a>      <span class=p>{</span> <span class=n>user</span><span class=p>:</span> <span class=n>fastagency</span><span class=p>,</span> <span class=n>password</span><span class=p>:</span> <span class=err>$</span><span class=n>FASTAGENCY_NATS_PASSWORD</span> <span class=p>}</span>
<a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a>    <span class=p>]</span>
<a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a>  <span class=p>}</span>
<a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a>  <span class=n>SYS</span> <span class=p>{}</span>
<a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a><span class=p>}</span>
<a id=__codelineno-37-22 name=__codelineno-37-22 href=#__codelineno-37-22></a>
<a id=__codelineno-37-23 name=__codelineno-37-23 href=#__codelineno-37-23></a><span class=n>system_account</span><span class=p>:</span> <span class=n>SYS</span>
<a id=__codelineno-37-24 name=__codelineno-37-24 href=#__codelineno-37-24></a>
<a id=__codelineno-37-25 name=__codelineno-37-25 href=#__codelineno-37-25></a><span class=c1># start the nats docker container with the following command</span>
<a id=__codelineno-37-26 name=__codelineno-37-26 href=#__codelineno-37-26></a><span class=c1># docker run -d --name nats-fastagency --rm -p 4222:4222 -p 9222:9222 -p 8222:8222 -v $(pwd)/nats-server.conf:/etc/nats/nats-server.conf -e FASTAGENCY_NATS_PASSWORD=&#39;fastagency_nats_password&#39; nats:latest -c /etc/nats/nats-server.conf</span>
</code></pre></div> </details></p> <p><details> <summary>workflow.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=kn>from</span> <span class=nn>autogen.agentchat</span> <span class=kn>import</span> <span class=n>ConversableAgent</span>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=kn>from</span> <span class=nn>fastagency</span> <span class=kn>import</span> <span class=n>UI</span>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=kn>from</span> <span class=nn>fastagency.runtimes.autogen</span> <span class=kn>import</span> <span class=n>AutoGenWorkflows</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a>
<a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a>
<a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=n>llm_config</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a>    <span class=s2>&quot;config_list&quot;</span><span class=p>:</span> <span class=p>[</span>
<a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a>        <span class=p>{</span>
<a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a>            <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a>            <span class=s2>&quot;api_key&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a>        <span class=p>}</span>
<a id=__codelineno-38-15 name=__codelineno-38-15 href=#__codelineno-38-15></a>    <span class=p>],</span>
<a id=__codelineno-38-16 name=__codelineno-38-16 href=#__codelineno-38-16></a>    <span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=mf>0.8</span><span class=p>,</span>
<a id=__codelineno-38-17 name=__codelineno-38-17 href=#__codelineno-38-17></a><span class=p>}</span>
<a id=__codelineno-38-18 name=__codelineno-38-18 href=#__codelineno-38-18></a>
<a id=__codelineno-38-19 name=__codelineno-38-19 href=#__codelineno-38-19></a><span class=n>wf</span> <span class=o>=</span> <span class=n>AutoGenWorkflows</span><span class=p>()</span>
<a id=__codelineno-38-20 name=__codelineno-38-20 href=#__codelineno-38-20></a>
<a id=__codelineno-38-21 name=__codelineno-38-21 href=#__codelineno-38-21></a>
<a id=__codelineno-38-22 name=__codelineno-38-22 href=#__codelineno-38-22></a><span class=nd>@wf</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;simple_learning&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Student and teacher learning chat&quot;</span><span class=p>)</span>
<a id=__codelineno-38-23 name=__codelineno-38-23 href=#__codelineno-38-23></a><span class=k>def</span> <span class=nf>simple_workflow</span><span class=p>(</span><span class=n>ui</span><span class=p>:</span> <span class=n>UI</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-38-24 name=__codelineno-38-24 href=#__codelineno-38-24></a>    <span class=n>initial_message</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>text_input</span><span class=p>(</span>
<a id=__codelineno-38-25 name=__codelineno-38-25 href=#__codelineno-38-25></a>        <span class=n>sender</span><span class=o>=</span><span class=s2>&quot;Workflow&quot;</span><span class=p>,</span>
<a id=__codelineno-38-26 name=__codelineno-38-26 href=#__codelineno-38-26></a>        <span class=n>recipient</span><span class=o>=</span><span class=s2>&quot;User&quot;</span><span class=p>,</span>
<a id=__codelineno-38-27 name=__codelineno-38-27 href=#__codelineno-38-27></a>        <span class=n>prompt</span><span class=o>=</span><span class=s2>&quot;I can help you learn about mathematics. What subject you would like to explore?&quot;</span><span class=p>,</span>
<a id=__codelineno-38-28 name=__codelineno-38-28 href=#__codelineno-38-28></a>    <span class=p>)</span>
<a id=__codelineno-38-29 name=__codelineno-38-29 href=#__codelineno-38-29></a>
<a id=__codelineno-38-30 name=__codelineno-38-30 href=#__codelineno-38-30></a>    <span class=n>student_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-38-31 name=__codelineno-38-31 href=#__codelineno-38-31></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Student_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-38-32 name=__codelineno-38-32 href=#__codelineno-38-32></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a student willing to learn.&quot;</span><span class=p>,</span>
<a id=__codelineno-38-33 name=__codelineno-38-33 href=#__codelineno-38-33></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-38-34 name=__codelineno-38-34 href=#__codelineno-38-34></a>        <span class=c1># human_input_mode=&quot;ALWAYS&quot;,</span>
<a id=__codelineno-38-35 name=__codelineno-38-35 href=#__codelineno-38-35></a>    <span class=p>)</span>
<a id=__codelineno-38-36 name=__codelineno-38-36 href=#__codelineno-38-36></a>    <span class=n>teacher_agent</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-38-37 name=__codelineno-38-37 href=#__codelineno-38-37></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Teacher_Agent&quot;</span><span class=p>,</span>
<a id=__codelineno-38-38 name=__codelineno-38-38 href=#__codelineno-38-38></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;You are a math teacher.&quot;</span><span class=p>,</span>
<a id=__codelineno-38-39 name=__codelineno-38-39 href=#__codelineno-38-39></a>        <span class=n>llm_config</span><span class=o>=</span><span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-38-40 name=__codelineno-38-40 href=#__codelineno-38-40></a>        <span class=c1># human_input_mode=&quot;ALWAYS&quot;,</span>
<a id=__codelineno-38-41 name=__codelineno-38-41 href=#__codelineno-38-41></a>    <span class=p>)</span>
<a id=__codelineno-38-42 name=__codelineno-38-42 href=#__codelineno-38-42></a>
<a id=__codelineno-38-43 name=__codelineno-38-43 href=#__codelineno-38-43></a>    <span class=n>chat_result</span> <span class=o>=</span> <span class=n>student_agent</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span>
<a id=__codelineno-38-44 name=__codelineno-38-44 href=#__codelineno-38-44></a>        <span class=n>teacher_agent</span><span class=p>,</span>
<a id=__codelineno-38-45 name=__codelineno-38-45 href=#__codelineno-38-45></a>        <span class=n>message</span><span class=o>=</span><span class=n>initial_message</span><span class=p>,</span>
<a id=__codelineno-38-46 name=__codelineno-38-46 href=#__codelineno-38-46></a>        <span class=n>summary_method</span><span class=o>=</span><span class=s2>&quot;reflection_with_llm&quot;</span><span class=p>,</span>
<a id=__codelineno-38-47 name=__codelineno-38-47 href=#__codelineno-38-47></a>        <span class=n>max_turns</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
<a id=__codelineno-38-48 name=__codelineno-38-48 href=#__codelineno-38-48></a>    <span class=p>)</span>
<a id=__codelineno-38-49 name=__codelineno-38-49 href=#__codelineno-38-49></a>
<a id=__codelineno-38-50 name=__codelineno-38-50 href=#__codelineno-38-50></a>    <span class=k>return</span> <span class=n>chat_result</span><span class=o>.</span><span class=n>summary</span>  <span class=c1># type: ignore[no-any-return]</span>
</code></pre></div> </details></p> <p><details> <summary>main_1_nats.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=kn>from</span> <span class=nn>fastagency.adapters.nats</span> <span class=kn>import</span> <span class=n>NatsAdapter</span>
<a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a>
<a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=kn>from</span> <span class=nn>.workflow</span> <span class=kn>import</span> <span class=n>wf</span>
<a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a>
<a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a>
<a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a><span class=n>nats_url</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;NATS_URL&quot;</span><span class=p>,</span> <span class=s2>&quot;nats://localhost:4222&quot;</span><span class=p>)</span>
<a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a><span class=n>user</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;fastagency&quot;</span>
<a id=__codelineno-39-12 name=__codelineno-39-12 href=#__codelineno-39-12></a><span class=n>password</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;FASTAGENCY_NATS_PASSWORD&quot;</span><span class=p>,</span> <span class=s2>&quot;fastagency_nats_password&quot;</span><span class=p>)</span>  <span class=c1># type: ignore[assignment]</span>
<a id=__codelineno-39-13 name=__codelineno-39-13 href=#__codelineno-39-13></a>
<a id=__codelineno-39-14 name=__codelineno-39-14 href=#__codelineno-39-14></a><span class=n>adapter</span> <span class=o>=</span> <span class=n>NatsAdapter</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>wf</span><span class=p>,</span> <span class=n>nats_url</span><span class=o>=</span><span class=n>nats_url</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>user</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
<a id=__codelineno-39-15 name=__codelineno-39-15 href=#__codelineno-39-15></a>
<a id=__codelineno-39-16 name=__codelineno-39-16 href=#__codelineno-39-16></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>lifespan</span><span class=o>=</span><span class=n>adapter</span><span class=o>.</span><span class=n>lifespan</span><span class=p>)</span>
<a id=__codelineno-39-17 name=__codelineno-39-17 href=#__codelineno-39-17></a>
<a id=__codelineno-39-18 name=__codelineno-39-18 href=#__codelineno-39-18></a>
<a id=__codelineno-39-19 name=__codelineno-39-19 href=#__codelineno-39-19></a><span class=c1># this is optional, but we would like to see the list of workflows</span>
<a id=__codelineno-39-20 name=__codelineno-39-20 href=#__codelineno-39-20></a><span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
<a id=__codelineno-39-21 name=__codelineno-39-21 href=#__codelineno-39-21></a><span class=k>def</span> <span class=nf>list_workflows</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<a id=__codelineno-39-22 name=__codelineno-39-22 href=#__codelineno-39-22></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;Workflows&quot;</span><span class=p>:</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>wf</span><span class=o>.</span><span class=n>get_description</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>wf</span><span class=o>.</span><span class=n>names</span><span class=p>}}</span>
<a id=__codelineno-39-23 name=__codelineno-39-23 href=#__codelineno-39-23></a>
<a id=__codelineno-39-24 name=__codelineno-39-24 href=#__codelineno-39-24></a>
<a id=__codelineno-39-25 name=__codelineno-39-25 href=#__codelineno-39-25></a><span class=c1># start the adapter with the following command</span>
<a id=__codelineno-39-26 name=__codelineno-39-26 href=#__codelineno-39-26></a><span class=c1># uvicorn main_1_nats:app --reload</span>
</code></pre></div> </details></p> <p><details> <summary>main_2_fastapi.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=kn>from</span> <span class=nn>os</span> <span class=kn>import</span> <span class=n>environ</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=kn>from</span> <span class=nn>fastagency.adapters.nats</span> <span class=kn>import</span> <span class=n>NatsAdapter</span>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a><span class=n>nats_url</span> <span class=o>=</span> <span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;NATS_URL&quot;</span><span class=p>,</span> <span class=s2>&quot;nats://localhost:4222&quot;</span><span class=p>)</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a><span class=n>nats_user</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;fastagency&quot;</span>
<a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a><span class=n>nats_password</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;FASTAGENCY_NATS_PASSWORD&quot;</span><span class=p>,</span> <span class=s2>&quot;fastagency_nats_password&quot;</span><span class=p>)</span>  <span class=c1># type: ignore[assignment]</span>
<a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a>
<a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a><span class=n>provider</span> <span class=o>=</span> <span class=n>NatsAdapter</span><span class=o>.</span><span class=n>create_provider</span><span class=p>(</span>
<a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a>    <span class=n>nats_url</span><span class=o>=</span><span class=n>nats_url</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>nats_user</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>nats_password</span>
<a id=__codelineno-40-14 name=__codelineno-40-14 href=#__codelineno-40-14></a><span class=p>)</span>
<a id=__codelineno-40-15 name=__codelineno-40-15 href=#__codelineno-40-15></a>
<a id=__codelineno-40-16 name=__codelineno-40-16 href=#__codelineno-40-16></a><span class=n>adapter</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=p>(</span>
<a id=__codelineno-40-17 name=__codelineno-40-17 href=#__codelineno-40-17></a>    <span class=n>provider</span><span class=o>=</span><span class=n>provider</span><span class=p>,</span>
<a id=__codelineno-40-18 name=__codelineno-40-18 href=#__codelineno-40-18></a><span class=p>)</span>
<a id=__codelineno-40-19 name=__codelineno-40-19 href=#__codelineno-40-19></a>
<a id=__codelineno-40-20 name=__codelineno-40-20 href=#__codelineno-40-20></a><span class=c1># app = FastAPI(lifespan=provider.lifespan)</span>
<a id=__codelineno-40-21 name=__codelineno-40-21 href=#__codelineno-40-21></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
<a id=__codelineno-40-22 name=__codelineno-40-22 href=#__codelineno-40-22></a><span class=n>app</span><span class=o>.</span><span class=n>include_router</span><span class=p>(</span><span class=n>adapter</span><span class=o>.</span><span class=n>router</span><span class=p>)</span>
<a id=__codelineno-40-23 name=__codelineno-40-23 href=#__codelineno-40-23></a>
<a id=__codelineno-40-24 name=__codelineno-40-24 href=#__codelineno-40-24></a>
<a id=__codelineno-40-25 name=__codelineno-40-25 href=#__codelineno-40-25></a><span class=c1># this is optional, but we would like to see the list of available workflows</span>
<a id=__codelineno-40-26 name=__codelineno-40-26 href=#__codelineno-40-26></a><span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
<a id=__codelineno-40-27 name=__codelineno-40-27 href=#__codelineno-40-27></a><span class=k>def</span> <span class=nf>read_root</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]:</span>
<a id=__codelineno-40-28 name=__codelineno-40-28 href=#__codelineno-40-28></a>    <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-40-29 name=__codelineno-40-29 href=#__codelineno-40-29></a>        <span class=s2>&quot;Workflows&quot;</span><span class=p>:</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>provider</span><span class=o>.</span><span class=n>get_description</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>provider</span><span class=o>.</span><span class=n>names</span><span class=p>}</span>
<a id=__codelineno-40-30 name=__codelineno-40-30 href=#__codelineno-40-30></a>    <span class=p>}</span>
<a id=__codelineno-40-31 name=__codelineno-40-31 href=#__codelineno-40-31></a>
<a id=__codelineno-40-32 name=__codelineno-40-32 href=#__codelineno-40-32></a>
<a id=__codelineno-40-33 name=__codelineno-40-33 href=#__codelineno-40-33></a><span class=c1># start the provider with the following command</span>
<a id=__codelineno-40-34 name=__codelineno-40-34 href=#__codelineno-40-34></a><span class=c1># uvicorn main_2_fastapi:app --host 0.0.0.0 --port 8008 --reload</span>
</code></pre></div> </details></p> <p><details> <summary>main_3_mesop.py</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=kn>from</span> <span class=nn>fastagency.adapters.fastapi</span> <span class=kn>import</span> <span class=n>FastAPIAdapter</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=kn>from</span> <span class=nn>fastagency.app</span> <span class=kn>import</span> <span class=n>FastAgency</span>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=kn>from</span> <span class=nn>fastagency.ui.mesop</span> <span class=kn>import</span> <span class=n>MesopUI</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=n>fastapi_url</span> <span class=o>=</span> <span class=s2>&quot;http://localhost:8008&quot;</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=n>provider</span> <span class=o>=</span> <span class=n>FastAPIAdapter</span><span class=o>.</span><span class=n>create_provider</span><span class=p>(</span>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a>    <span class=n>fastapi_url</span><span class=o>=</span><span class=n>fastapi_url</span><span class=p>,</span>
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a><span class=p>)</span>
<a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a>
<a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAgency</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=n>provider</span><span class=p>,</span> <span class=n>ui</span><span class=o>=</span><span class=n>MesopUI</span><span class=p>())</span>
<a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a>
<a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a><span class=c1># start the provider with the following command</span>
<a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a><span class=c1># gunicorn main_3_mesop:app -b 0.0.0.0:8888 --reload</span>
</code></pre></div> </details></p> </div> </div> </div> <h3 id=run-application>Run Application<a class=headerlink href=#run-application title="Permanent link">#</a></h3> <p>Once everything is set up, you can run your FastAgency application using the following command:</p> <div class="tabbed-set tabbed-alternate" data-tabs=8:4><input checked=checked id=console_4 name=__tabbed_8 type=radio><input id=mesop_6 name=__tabbed_8 type=radio><input id=fastapi--mesop_6 name=__tabbed_8 type=radio><input id=nats--fastapi--mesop_6 name=__tabbed_8 type=radio><div class=tabbed-labels><label for=console_4>Console</label><label for=mesop_6>Mesop</label><label for=fastapi--mesop_6>FastAPI + Mesop</label><label for=nats--fastapi--mesop_6>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="admonition note"> <p class=admonition-title>Terminal</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=go>fastagency run</span>
</code></pre></div> </div> </div> <div class=tabbed-block> <p>The preferred way to run the <a href=https://google.github.io/mesop/ target=_blank><strong>Mesop</strong></a> application is using a Python WSGI HTTP server like <a href=https://gunicorn.org/ target=_blank><strong>Gunicorn</strong></a> on Linux and Mac or <a href=https://docs.pylonsproject.org/projects/waitress/en/stable/ target=_blank><strong>Waitress</strong></a> on Windows.</p> <div class="tabbed-set tabbed-alternate" data-tabs=9:2><input checked=checked id=cookiecutter name=__tabbed_9 type=radio><input id=env--pip name=__tabbed_9 type=radio><div class=tabbed-labels><label for=cookiecutter>Cookiecutter</label><label for=env--pip>env + pip</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="admonition note"> <p class=admonition-title>Terminal</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=go>gunicorn main:app</span>
</code></pre></div> </div> </div> <div class=tabbed-block> <p>First, install the package using package manager such as <code>pip</code> and then run it:</p> <div class="tabbed-set tabbed-alternate" data-tabs=10:2><input checked=checked id=linuxmacos_1 name=__tabbed_10 type=radio><input id=windows_1 name=__tabbed_10 type=radio><div class=tabbed-labels><label for=linuxmacos_1>Linux/MacOS</label><label for=windows_1>Windows</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="admonition note"> <p class=admonition-title>Terminal</p> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=go>pip install gunicorn</span>
<a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=go>gunicorn main:app</span>
</code></pre></div> </div> </div> <div class=tabbed-block> <div class="admonition note"> <p class=admonition-title>Terminal</p> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=go>pip install waitress</span>
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=go>waitress-serve --listen=0.0.0.0:8000 main:app</span>
</code></pre></div> </div> </div> </div> </div> </div> </div> </div> </div> <div class=tabbed-block> <p>In this setup, we need to run <strong>two</strong> commands in <strong>separate</strong> terminal windows:</p> <div class="tabbed-set tabbed-alternate" data-tabs=11:2><input checked=checked id=cookiecutter_1 name=__tabbed_11 type=radio><input id=env--pip_1 name=__tabbed_11 type=radio><div class=tabbed-labels><label for=cookiecutter_1>Cookiecutter</label><label for=env--pip_1>env + pip</label></div> <div class=tabbed-content> <div class=tabbed-block> <ul> <li>Start <strong>FastAPI</strong> application using uvicorn:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 1</p> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a>uvicorn main_1_fastapi:app --host 0.0.0.0 --port 8008 --reload
</code></pre></div> </div> <ul> <li>Start <strong>Mesop</strong> web interface using gunicorn:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 2</p> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a>gunicorn main_2_mesop:app -b 0.0.0.0:8888 --reload
</code></pre></div> </div> </div> <div class=tabbed-block> <p>First, install the package using package manager such as <code>pip</code> and then run it:</p> <div class="tabbed-set tabbed-alternate" data-tabs=12:2><input checked=checked id=linuxmacos_2 name=__tabbed_12 type=radio><input id=windows_2 name=__tabbed_12 type=radio><div class=tabbed-labels><label for=linuxmacos_2>Linux/MacOS</label><label for=windows_2>Windows</label></div> <div class=tabbed-content> <div class=tabbed-block> <ul> <li>Start <strong>FastAPI</strong> application using uvicorn:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 1</p> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a>pip install uvicorn
<a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>uvicorn main_1_fastapi:app --host 0.0.0.0 --port 8008 --reload
</code></pre></div> </div> <ul> <li>Start <strong>Mesop</strong> web interface using gunicorn:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 2</p> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a>pip install gunicorn
<a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a>gunicorn main_2_mesop:app -b 0.0.0.0:8888 --reload
</code></pre></div> </div> </div> <div class=tabbed-block> <ul> <li>Start <strong>FastAPI</strong> application using uvicorn:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 1</p> <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a>pip install uvicorn
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a>uvicorn main_1_fastapi:app --host 0.0.0.0 --port 8008 --reload
</code></pre></div> </div> <ul> <li>Start <strong>Mesop</strong> web interface using waitress:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 2</p> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a>pip install waitress
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>waitress-serve --listen=0.0.0.0:8888 main_2_mesop:app
</code></pre></div> </div> </div> </div> </div> </div> </div> </div> </div> <div class=tabbed-block> <div class="tabbed-set tabbed-alternate" data-tabs=13:2><input checked=checked id=cookiecutter_2 name=__tabbed_13 type=radio><input id=env--pip_2 name=__tabbed_13 type=radio><div class=tabbed-labels><label for=cookiecutter_2>Cookiecutter</label><label for=env--pip_2>env + pip</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>The <strong>NATS</strong> docker container is started automatically by Cookiecutter for this setup. In this setup, we need to run <strong>three</strong> commands in <strong>separate</strong> terminal windows:</p> <ul> <li>Start <strong>FastAPI</strong> application that provides a conversational workflow:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 1</p> <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a>uvicorn main_1_nats:app --reload
</code></pre></div> </div> <ul> <li>Start <strong>FastAPI</strong> application integrated with a <strong>NATS</strong> messaging system:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 2</p> <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a>uvicorn main_2_fastapi:app --host 0.0.0.0 --port 8008 --reload
</code></pre></div> </div> <ul> <li>Start <strong>Mesop</strong> web interface using gunicorn:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 3</p> <div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a>gunicorn main_3_mesop:app -b 0.0.0.0:8888 --reload
</code></pre></div> </div> </div> <div class=tabbed-block> <p>First, install the package using package manager such as <code>pip</code> and then run it. In this setup, we need to run <strong>four</strong> commands in <strong>separate</strong> terminal windows:</p> <div class="tabbed-set tabbed-alternate" data-tabs=14:2><input checked=checked id=linuxmacos_3 name=__tabbed_14 type=radio><input id=windows_3 name=__tabbed_14 type=radio><div class=tabbed-labels><label for=linuxmacos_3>Linux/MacOS</label><label for=windows_3>Windows</label></div> <div class=tabbed-content> <div class=tabbed-block> <ul> <li>Start <strong>NATS</strong> Docker container:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 1</p> <div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a>docker run -d --name nats-fastagency --rm -p 4222:4222 -p 9222:9222 -p 8222:8222 -v $(pwd)/nats-server.conf:/etc/nats/nats-server.conf -e FASTAGENCY_NATS_PASSWORD=&#39;fastagency_nats_password&#39; nats:latest -c /etc/nats/nats-server.conf
</code></pre></div> </div> <ul> <li>Start <strong>FastAPI</strong> application that provides a conversational workflow:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 2</p> <div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a>pip install uvicorn
<a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>uvicorn main_1_nats:app --reload
</code></pre></div> </div> <ul> <li>Start <strong>FastAPI</strong> application integrated with a <strong>NATS</strong> messaging system:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 3</p> <div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a>uvicorn main_2_fastapi:app --host 0.0.0.0 --port 8008 --reload
</code></pre></div> </div> <ul> <li>Start <strong>Mesop</strong> web interface using gunicorn:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 4</p> <div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a>pip install gunicorn
<a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>gunicorn main_3_mesop:app -b 0.0.0.0:8888 --reload
</code></pre></div> </div> </div> <div class=tabbed-block> <ul> <li>Start <strong>NATS</strong> Docker container:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 1</p> <div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a>docker run -d --name nats-fastagency --rm -p 4222:4222 -p 9222:9222 -p 8222:8222 -v $(pwd)/nats-server.conf:/etc/nats/nats-server.conf -e FASTAGENCY_NATS_PASSWORD=&#39;fastagency_nats_password&#39; nats:latest -c /etc/nats/nats-server.conf
</code></pre></div> </div> <ul> <li>Start <strong>FastAPI</strong> application that provides a conversational workflow:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 2</p> <div class=highlight><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a>pip install uvicorn
<a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a>uvicorn main_1_nats:app --reload
</code></pre></div> </div> <ul> <li>Start <strong>FastAPI</strong> application integrated with a <strong>NATS</strong> messaging system:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 3</p> <div class=highlight><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a>uvicorn main_2_fastapi:app --host 0.0.0.0 --port 8008 --reload
</code></pre></div> </div> <ul> <li>Start <strong>Mesop</strong> web interface using waitress:</li> </ul> <div class="admonition note"> <p class=admonition-title>Terminal 4</p> <div class=highlight><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a>pip install waitress
<a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a>waitress-serve --listen=0.0.0.0:8888 main_3_mesop:app
</code></pre></div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <h3 id=output>Output<a class=headerlink href=#output title="Permanent link">#</a></h3> <p>The outputs will vary based on the interface, here is the output of the last terminal starting UI:</p> <div class="tabbed-set tabbed-alternate" data-tabs=15:4><input checked=checked id=console_5 name=__tabbed_15 type=radio><input id=mesop_7 name=__tabbed_15 type=radio><input id=fastapi--mesop_7 name=__tabbed_15 type=radio><input id=nats--fastapi--mesop_7 name=__tabbed_15 type=radio><div class=tabbed-labels><label for=console_5>Console</label><label for=mesop_7>Mesop</label><label for=fastapi--mesop_7>FastAPI + Mesop</label><label for=nats--fastapi--mesop_7>NATS + FastAPI + Mesop</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=go>╭─ Python module file ─╮</span>
<a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a><span class=go>│                      │</span>
<a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=go>│  🐍 main.py          │</span>
<a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a><span class=go>│                      │</span>
<a id=__codelineno-63-5 name=__codelineno-63-5 href=#__codelineno-63-5></a><span class=go>╰──────────────────────╯</span>
<a id=__codelineno-63-6 name=__codelineno-63-6 href=#__codelineno-63-6></a>
<a id=__codelineno-63-7 name=__codelineno-63-7 href=#__codelineno-63-7></a><span class=go>╭─ Importable FastAgency app ─╮</span>
<a id=__codelineno-63-8 name=__codelineno-63-8 href=#__codelineno-63-8></a><span class=go>│                             │</span>
<a id=__codelineno-63-9 name=__codelineno-63-9 href=#__codelineno-63-9></a><span class=go>│  from main import app       │</span>
<a id=__codelineno-63-10 name=__codelineno-63-10 href=#__codelineno-63-10></a><span class=go>│                             │</span>
<a id=__codelineno-63-11 name=__codelineno-63-11 href=#__codelineno-63-11></a><span class=go>╰─────────────────────────────╯</span>
<a id=__codelineno-63-12 name=__codelineno-63-12 href=#__codelineno-63-12></a>
<a id=__codelineno-63-13 name=__codelineno-63-13 href=#__codelineno-63-13></a><span class=go>╭─ FastAgency -&gt; user [workflow_started] ──────────────────────────────────────╮</span>
<a id=__codelineno-63-14 name=__codelineno-63-14 href=#__codelineno-63-14></a><span class=go>│                                                                              │</span>
<a id=__codelineno-63-15 name=__codelineno-63-15 href=#__codelineno-63-15></a><span class=go>│ {                                                                            │</span>
<a id=__codelineno-63-16 name=__codelineno-63-16 href=#__codelineno-63-16></a><span class=go>│   &quot;name&quot;: &quot;simple_learning&quot;,                                                 │</span>
<a id=__codelineno-63-17 name=__codelineno-63-17 href=#__codelineno-63-17></a><span class=go>│   &quot;description&quot;: &quot;Student and teacher                                        │</span>
<a id=__codelineno-63-18 name=__codelineno-63-18 href=#__codelineno-63-18></a><span class=go>│ learning chat&quot;,                                                              │</span>
<a id=__codelineno-63-19 name=__codelineno-63-19 href=#__codelineno-63-19></a><span class=go>│   &quot;params&quot;: {}                                                               │</span>
<a id=__codelineno-63-20 name=__codelineno-63-20 href=#__codelineno-63-20></a><span class=go>│ }                                                                            │</span>
<a id=__codelineno-63-21 name=__codelineno-63-21 href=#__codelineno-63-21></a><span class=go>╰──────────────────────────────────────────────────────────────────────────────╯</span>
<a id=__codelineno-63-22 name=__codelineno-63-22 href=#__codelineno-63-22></a>
<a id=__codelineno-63-23 name=__codelineno-63-23 href=#__codelineno-63-23></a><span class=go>╭─ Workflow -&gt; User [text_input] ──────────────────────────────────────────────╮</span>
<a id=__codelineno-63-24 name=__codelineno-63-24 href=#__codelineno-63-24></a><span class=go>│                                                                              │</span>
<a id=__codelineno-63-25 name=__codelineno-63-25 href=#__codelineno-63-25></a><span class=go>│ I can help you learn about geometry. What subject you would like to          │</span>
<a id=__codelineno-63-26 name=__codelineno-63-26 href=#__codelineno-63-26></a><span class=go>│ explore?:                                                                    │</span>
<a id=__codelineno-63-27 name=__codelineno-63-27 href=#__codelineno-63-27></a><span class=go>╰──────────────────────────────────────────────────────────────────────────────╯</span>
</code></pre></div> <p>For Console applications, you will see a command-line prompt where you can enter the initial message and interact with your workflow.</p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Starting gunicorn 23.0.0</span>
<a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Listening at: http://127.0.0.1:8000 (23635)</span>
<a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Using worker: sync</span>
<a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a><span class=go>[2024-10-10 13:19:18 +0530] [23645] [INFO] Booting worker with pid: 23645</span>
</code></pre></div> <p><a class=glightbox href=images/chat.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Initial message" src=images/chat.png></a></p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Starting gunicorn 23.0.0</span>
<a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Listening at: http://127.0.0.1:8888 (23635)</span>
<a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Using worker: sync</span>
<a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a><span class=go>[2024-10-10 13:19:18 +0530] [23645] [INFO] Booting worker with pid: 23645</span>
</code></pre></div> <p><a class=glightbox href=images/chat.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Initial message" src=images/chat.png></a></p> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Starting gunicorn 23.0.0</span>
<a id=__codelineno-66-2 name=__codelineno-66-2 href=#__codelineno-66-2></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Listening at: http://127.0.0.1:8888 (23635)</span>
<a id=__codelineno-66-3 name=__codelineno-66-3 href=#__codelineno-66-3></a><span class=go>[2024-10-10 13:19:18 +0530] [23635] [INFO] Using worker: sync</span>
<a id=__codelineno-66-4 name=__codelineno-66-4 href=#__codelineno-66-4></a><span class=go>[2024-10-10 13:19:18 +0530] [23645] [INFO] Booting worker with pid: 23645</span>
</code></pre></div> <p><a class=glightbox href=images/chat.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Initial message" src=images/chat.png></a></p> </div> </div> </div> <h3 id=building-the-docker-image>Building the Docker Image<a class=headerlink href=#building-the-docker-image title="Permanent link">#</a></h3> <p>If you created the project using Cookiecutter, then building the Docker image is as simple as running the provided script, as shown below:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a><span class=go>./scripts/build_docker.sh</span>
</code></pre></div> <p>Alternatively, you can use the following command to build the Docker image:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a><span class=go>docker build -t deploy_fastagency -f docker/Dockerfile --progress plain .</span>
</code></pre></div> <h3 id=running-the-docker-image>Running the Docker Image<a class=headerlink href=#running-the-docker-image title="Permanent link">#</a></h3> <p>Similarly, running the Docker container is as simple as running the provided script, as shown below:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a><span class=go>./scripts/run_docker.sh</span>
</code></pre></div> <p>Alternatively, you can use the following command to run the Docker container using the Docker image built in the previous step:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a><span class=go>docker run -d --name deploy_fastagency -e OPENAI_API_KEY=$OPENAI_API_KEY -p 8888:8888  deploy_fastagency</span>
</code></pre></div> <h3 id=deploying-to-flyio>Deploying to Fly.io<a class=headerlink href=#deploying-to-flyio title="Permanent link">#</a></h3> <p>If you created the project using Cookiecutter, there is a built-in script to deploy your workflow to <a href=https://fly.io/ ><strong>Fly.io</strong></a>. Run it as shown below:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a><span class=go>./scripts/deploy_to_fly_io.sh</span>
</code></pre></div> <p>Alternatively, you can run the following commands one by one to deploy your workflow to <a href=https://fly.io/ ><strong>Fly.io</strong></a>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a><span class=go>fly auth login</span>
<a id=__codelineno-72-2 name=__codelineno-72-2 href=#__codelineno-72-2></a>
<a id=__codelineno-72-3 name=__codelineno-72-3 href=#__codelineno-72-3></a><span class=go>fly launch --config fly.toml --copy-config --yes</span>
<a id=__codelineno-72-4 name=__codelineno-72-4 href=#__codelineno-72-4></a>
<a id=__codelineno-72-5 name=__codelineno-72-5 href=#__codelineno-72-5></a><span class=go>fly secrets set OPENAI_API_KEY=$OPENAI_API_KEY</span>
</code></pre></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-10-25T14:11:41+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-10-25</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: User Guide"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> User Guide </div> </div> </a> <a href=../cookiecutter/ class="md-footer__link md-footer__link--next" aria-label="Next: Project setup"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Project setup </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2024 onwards <a href=https://airt.ai/ target=_blank rel=noopener>airt</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/kJjSGWrknU target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://github.com/airtai/fastagency target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> <a href=https://x.com/FastAgencyAI target=_blank rel=noopener title=x.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> <a href=https://www.facebook.com/airt.ai.api/ target=_blank rel=noopener title=www.facebook.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg> </a> <a href=https://www.linkedin.com/company/airt-ai/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.tracking", "navigation.prune", "navigation.top", "navigation.footer", "content.tabs.link", "content.code.copy", "content.code.annotate", "content.action.edit"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.83f73b43.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../javascripts/extra.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>